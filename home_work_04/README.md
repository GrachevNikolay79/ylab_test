# Задание 4

## Анонимный пользователь может:
* Создать аккаунт, если выбранный username еще не зарегистрирован в системе.
* Войти в свой аккаунт по username и паролю.
* Просмотреть список постов.
* Просмотреть детально определенный пост.

## Авторизованный пользователь может:
* Просмотреть свой профиль.
* Создать пост.
* Изменить свои личные данные — email, username и др. И получить новый access_token

## Задание со звездочкой:
* Валидировать данные при регистраций и обновлений данных пользователя
* Хранить в Redis заблокированные access_tokens (удобно хранить это в разных базах)
* Хранить в Redis активные refresh_tokens для определенного пользователя (удобно хранить это в разных базах)
* Добавить метод выхода из аккаунта (на этом этапе надо добавить access_token в список заблокированных токенов в Redis, удалить refresh_token из списка активных токенов в Redis определенного пользователя)
* Выйти со всех устройств. (удалить все активные refresh_token для определенного пользователя)

<br>
<br>

П.С.:
1. Любой токен содержит в себе два UUID обоих токенов как _access_token_, так и _refresh_tocken_, и ключ в редисе сделан либо
__access_token_id:user_id:refresh_tocken_id__, либо __refresh_tocken_id:user_id:access_token_id__, получается, что оба токена знают друг про друга, 
и в случае logout'а пользователя с определенного устройства мы можем оба токена найти и удалить, т.к. они более не нужны,
в случае массового выхода, удаляем все токены по маске *:user_id:*
2. В случае получения новой пары токенов, старые удаляются
3. в случае редактирования профиля пользователя, происходит получения новых токенов, т.е. токены выдаются только в паре, т.к. они связаны и знают друг о друге.
4. не сделано: при выходе добавлять _access_token_ в список заблокированных, __ибо не понятно зачем?__ 
т.к. если пользователь авторизован, то в редисе есть обе записи обоих токенов, если записей в редисе нет, то пользователь считается не авторизованным,
при выходе токены из редиса удаляются. 
5. приложен файл для постмана, немножко поправленный ({{URL}}, заменен на {{LOCAL_URL}}, где-то добавлены необходимые кавычки,
и в PATCH при получении ответа, добавлено обновление токенов)
6. у пользователя id это uuid, в принципе в 1С также, вроде не сильно жалуются, но практика показала, что лучше было использовать int